SUBROUTINE TOCUBIC (T, TC, PC, W, P, R, CUB1, CUB2, CUB3, ACUB, BCUB, AC, BZ)
  IMPLICIT NONE
  REAL, INTENT(IN) :: T, TC, PC, W, P, R
  REAL, INTENT(OUT) :: CUB1, CUB2, CUB3, ACUB, BCUB, AC, BZ
  REAL :: TR, AT, K

  IF (W .LE. 0.49) THEN
    K = 0.3746 + 1.54226*W - 0.26992*W**2
  ELSE
    K = 0.379642 + 1.48503*W -0.164423*W**2 + 0.016666*W**3
  ENDIF

  TR = T/TC
  AC = 0.45724*R*R*TC*TC/PC
  BZ = 0.07780*R*TC/PC
  AT = AC*(1 + K*(1 - SQRT(TR)))**2

  ACUB = AT*P/((R*T)*(R*T))
  BCUB = BZ*P/(R*T)

  CUB1 = BCUB - 1
  CUB2 = ACUB - 2*BCUB - 3*BCUB*BCUB
  CUB3 = BCUB*BCUB*BCUB + BCUB*BCUB - ACUB*BCUB

  RETURN
END SUBROUTINE TOCUBIC
