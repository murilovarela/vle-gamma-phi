SUBROUTINE FUGACITY (T, TC1, TC2, PC1, PC2, W1, W2, PA, R, X1, X2, PHI1, PHI2)
  IMPLICIT NONE

  REAL, INTENT(IN) :: T, TC1, TC2, PC1, PC2, W1, W2, PA, R, X1, X2
  REAL, INTENT(OUT) :: PHI1, PHI2
  REAL :: CUB11, CUB21, CUB31, Z11, Z21, Z31, Z2I1, Z3I1, Z1, ACUB1, BCUB1, AC1, BZ1
  REAL :: CUB12, CUB22, CUB32, Z12, Z22, Z32, Z2I2, Z3I2, Z2, ACUB2, BCUB2, AC2, BZ2

  !TRANSFORMATION OF VALUES TO CUBIC FORMAT
  CALL TOCUBIC (T, TC1, PC1, W1, PA, R, CUB11, CUB21, CUB31, ACUB1, BCUB1, AC1, BZ1)
  CALL TOCUBIC (T, TC2, PC2, W2, PA, R, CUB12, CUB22, CUB32, ACUB2, BCUB2, AC2, BZ2)

  !DETERMINATION OF CUBIC ROOTS
  CALL SOLVECUBIC (CUB11, CUB21, CUB31, Z11, Z21, Z31, Z2I1, Z3I1)
  CALL SOLVECUBIC (CUB12, CUB22, CUB32, Z12, Z22, Z32, Z2I2, Z3I2)

  !CHOOSING CORRECT ROOTS
  CALL CHOOSEZ (Z11, Z21, Z31, Z2I1, Z3I1, ACUB1, BCUB1, Z1)
  CALL CHOOSEZ (Z12, Z22, Z32, Z2I2, Z3I2, ACUB2, BCUB2, Z2)

  !EVALUATION OF FUGACITY COEFFICIENT VALUE
  CALL CALCPHI (AC1, AC2, X1, X2, BZ1, BZ2, Z1, Z2, ACUB1, BCUB1, ACUB2, BCUB2, PHI1, PHI2)

END SUBROUTINE FUGACITY
